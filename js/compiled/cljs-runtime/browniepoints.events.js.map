{"version":3,"sources":["browniepoints/events.cljs"],"mappings":";AAMA,AAAA,AAAOA,AAAiBC;AAAxB,AACE,AAAA,AAAUC,AAAgC,AAAKD;;AAEjD,AAAA,AAAOE;AAAP,AACE,AAACC,AAAY,AAAA,AAAUF;;AAEzB,AAAA,AAACG,AAEA,AAAKC,AAAEA;AAAP,AACE,AAAMC,AAAG,AAACJ;AAAV,AACE,AAAII;AACFA;;AACAC;;;AAEP,AAAA,AAACH,AAEA,AAAAI,AAAKR;AAAL,AAAA,AAAAS,AAAAD;AAAA,AAAAE,AAAAD,AAAA,AAAA,AAASJ;AAAT,AAAAK,AAAAD,AAAA,AAAA,AAAWE;AAAX,AACE,AAAMC,AAAO,AAAA,AAAA,AAAA,AAACC,AAAUb,AAAYW,AAAWG;AAA/C,AACE,AAACf,AAAgBa;;AACjBA;;AAEL,AAAA,AAACR,AAEA,AAAAW,AAAKf;AAAL,AAAA,AAAAgB,AAAAD;AAAA,AAAAL,AAAAM,AAAA,AAAA,AAASX;AAAT,AAAAK,AAAAM,AAAA,AAAA,AAAWL;AAAX,AACE,AAAMC,AAAO,AAAA,AAAA,AAAA,AAAA,AAAAK,AAACJ,AAAUb,AAAYW;AAAvB,AAAmC,AAAAO,AAAA;AAAAC,AAAO,AAAAF,AAAA;AAAP,AAAA,AAAAC,AAAAC,AAAAD,AAAAC;;AAAhD,AACE,AAACpB,AAAgBa;;AACjBA;;AAEL,AAAA,AAACR,AAEA,AAAAgB,AAAKpB;AAAL,AAAA,AAAAqB,AAAAD;AAAA,AAAAV,AAAAW,AAAA,AAAA,AAAShB;AAAT,AAAAK,AAAAW,AAAA,AAAA,AAAWC;AAAX,AACE,AAAMC,AAAOD,AACA,AAAA,AAAA,AAACE,AACD,AAACC;AACRb,AAAO,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAACC,AAAUb,AAAa0B,AAAMH,AAAUD;AAHrD,AAKE,AAACvB,AAAgBa;;AACjBA;;AAEL,AAAA,AAACR,AAEA,AAAAuB,AAAK3B;AAAL,AAAA,AAAA4B,AAAAD;AAAA,AAAAjB,AAAAkB,AAAA,AAAA,AAASvB;AAAT,AAAAK,AAAAkB,AAAA,AAAA,AAAWjB;AAAX,AACE,AAAMC,AAAO,AAAA,AAAA,AAACC,AAAUb,AAAa6B,AAAOlB;AAA5C,AACE,AAACZ,AAAgBa;;AACjBA","names":["browniepoints.events/db->local-store","db","js/localStorage","browniepoints.events/local-store->db","clojure.edn.read_string","re_frame.core.reg_event_db","_","ls","browniepoints.db/default-db","p__42702","vec__42703","cljs.core.nth","k","new-db","cljs.core.update_in","cljs.core/inc","p__42707","vec__42708","p1__42706#","x__4214__auto__","y__4215__auto__","p__42711","vec__42712","name","kw","clojure.string/replace","cljs.core.keyword","cljs.core/assoc","p__42715","vec__42716","cljs.core/dissoc"],"sourcesContent":["(ns browniepoints.events\n  (:require [clojure.edn :refer [read-string]]\n            [clojure.string :as str]\n            [re-frame.core :as re-frame]\n            [browniepoints.db :as db]))\n\n(defn- db->local-store [db]\n  (.setItem js/localStorage \"browniepoints\" (str db)))\n\n(defn- local-store->db []\n  (read-string (.getItem js/localStorage \"browniepoints\")))\n\n(re-frame/reg-event-db\n ::initialize-db\n (fn [_ _]\n   (let [ls (local-store->db)]\n     (if ls\n       ls\n       db/default-db))))\n\n(re-frame/reg-event-db\n :inc\n (fn [db [_ k]]\n   (let [new-db (update-in db [:people k :points] inc)]\n     (db->local-store new-db)\n     new-db)))\n\n(re-frame/reg-event-db\n :dec\n (fn [db [_ k]]\n   (let [new-db (update-in db [:people k :points] #(max 0 (dec %)))]\n     (db->local-store new-db)\n     new-db)))\n\n(re-frame/reg-event-db\n :add-person\n (fn [db [_ name]]\n   (let [kw (-> name\n                (str/replace #\"\\s\" \"-\")\n                (keyword))\n         new-db (update-in db [:people] assoc kw {:name name\n                                                  :points 0})]\n     (db->local-store new-db)\n     new-db)))\n\n(re-frame/reg-event-db\n :del-person\n (fn [db [_ k]]\n   (let [new-db (update-in db [:people] dissoc k)]\n     (db->local-store new-db)\n     new-db)))\n"]}